@{
    ViewData["Title"] = "Home Page";
}

<script>
    var Url = "http://localhost:14183/api/checkIns";
    var updateTable = function () {
        $.ajax({
            type: 'get',
            url: Url,
            success: function (result) {
                var tbody = $("#checkInList > tbody");
                tbody.html(null);
                result.forEach(function (checkIn) {
                    tbody.append(
                        "<tr>" +
                        "<td>" + checkIn.personFullName + "</td>" +
                        "<td>" + checkIn.personSex + "</td>" +
                        "<td>" + checkIn.personBirthDate + "</td>" +
                        "<td>" + checkIn.checkInVisitDateTime + "</td>" +
                        "<td><button class='btn btn-default' onclick='deleteCheckIn(\"" + checkIn.checkInId + "\");'>Удалить</button>" +
                        "</tr>");
                });
            }
        });
    }

    var addVisitor = function() {
        $.ajax({
            url: Url,
            type: "POST",
            data: {
                PersonFirstName: $("#personFirstName").val(),
                PersonLastName: $("#personLastName").val(),
                PersonBirthDate: $("#personBirthDate").val(),
                PersonSex: $("input:radio[name='visitorSex']:checked").val()
            },
            success: function() {
                updateTable();
            }
        });
    }

    var deleteCheckIn = function(checkInId) {
        $.ajax({
            url: Url + "/" + checkInId,
            type: "DELETE",
            success: function() {
                updateTable();
            }
        });
    }
</script>

<div class="row">
    <div class="col-md-12">
        <div>
            <p>Данные посетителя</p>
            <div class="form-group">
                <label>Имя</label>
                <input type="text" id="personFirstName" class="form-control"/>
            </div>
            <div class="form-group">
                <label>Фамилия</label>
                <input type="text" id="personLastName" class="form-control"/>
            </div>
            <div class="form-group">
                <label>Дата рождения</label>
                <input type="date" id="personBirthDate" class="form-control"/>
            </div>
            <div class="form-group">
                <label>Пол</label>
                <label class="radio-inline">
                    <input type="radio" name="visitorSex" value="1" /> Мужской
                </label>
                <label class="radio-inline">
                    <input type="radio" name="visitorSex" value="2" /> Женский
                </label>
            </div>
            <button type="button" class="btn btn-default" onclick="addVisitor();">Добавить</button>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <table id="checkInList" class="table table-bordered">
            <thead>
            <tr>
                <th>ФИО</th>
                <th>Пол</th>
                <th>Дата рождения</th>
                <th>Время прихода</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
</div>

<script>
    $(document).ready(function () {
        updateTable();
    });
</script>